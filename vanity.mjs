import { keccak256, encodePacked, toHex } from "viem";

const FACTORY = "0x914d7Fec6aaC8cd542e72Bca78B30650d45643d7";

// ⚠️ tu bytecode como string:
const initCode = "0x60808060405234610027575f80546001600160a01b0319163317905561051a908161002c8239f35b5f80fdfe6080604081815260048036101561004a575b509050361561001e575f80fd5b513481527fbfe611b001dfcd411432f7bf0d79b82b4b2ee81511edac123a3403c357fb972a60203392a2005b5f92833560e01c9081632d2c556514610464575080638da5cb5b14610438578063a9ada625146101445763e086e5ec03610011573461014057826003193601126101405782546001600160a01b0316338190036100fd57479182156100c5575083808093819382f1156100bb575080f35b51903d90823e3d90fd5b606490602085519162461bcd60e51b835282015260126024820152714e6f2045544820746f20776974686472617760701b6044820152fd5b506020606492519162461bcd60e51b8352820152601b60248201527f4f6e6c79206f776e65722063616e2077697468647261772045544800000000006044820152fd5b8280fd5b5090346101405760e0366003190112610140576001600160a01b0390823582811691908290036104345760249384359384168094036104305760448035916084359160ff83168093036103f55733156103f957853b156103f557845163d505accf60e01b8152878382015230898201525f1982820152606493843585830152608482015260a43560a482015260c43560c4820152898160e481838b5af180156103eb576103be575b5060148402848104601414851517156103ac578390049788850394851161039b57908993929186516323b872dd60e01b908181528a8582015273ba62c2143d14a179aa11d647042031dbfccb3e86838201528b848201528981878160209a8b945af1908115610391578d91610374575b50156103355787519081528381018a90523382820152828101879052858186818f8d5af190811561032b578c916102fe575b50156102c95750508451978852505085015233937f6e97188f3d1ea8f844a0cde3a385ed4bcf84b0048562da5e2c206c4254ffc00b9190a480f35b865162461bcd60e51b815292830185905260149083015273155cd95c881d1c985b9cd9995c8819985a5b195960621b90820152fd5b61031e9150863d8811610324575b6103168183610492565b8101906104c8565b5f61028e565b503d61030c565b88513d8e823e3d90fd5b50865162461bcd60e51b81529283018590526018908301527f5472656173757279207472616e73666572206661696c6564000000000000000090820152fd5b61038b9150873d8911610324576103168183610492565b5f61025c565b89513d8f823e3d90fd5b634e487b7160e01b8a526011835289fd5b634e487b7160e01b8a5260118352888afd5b67ffffffffffffffff819a929a116103d9578552975f6101ec565b5060418892634e487b7160e01b835252fd5b86513d8c823e3d90fd5b8880fd5b9072125b9d985b1a59081cd85999481dd85b1b195d606a1b60649260138a602089519562461bcd60e51b8752860152840152820152fd5b8580fd5b8480fd5b505034610460578160031936011261046057905490516001600160a01b039091168152602090f35b5080fd5b8490346104605781600319360112610460578073ba62c2143d14a179aa11d647042031dbfccb3e8660209252f35b90601f8019910116810190811067ffffffffffffffff8211176104b457604052565b634e487b7160e01b5f52604160045260245ffd5b908160209103126104e0575180151581036104e05790565b5f80fdfea2646970667358221220989753e700a24d5b1de44b0d27bf5fd581cf4ed6f5ecc0779e920d6ef98b3efc64736f6c63430008140033000000000000000000000000a6cab323b3780965a9b74d594e5d87ec7ea8f7990000000000000000000000000000000000000000000000000000000000000001" // completo
const initCodeHash = keccak256(initCode);

function computeAddress(factory, salt, initCodeHash) {
  const packed = encodePacked(
    ["bytes1", "address", "bytes32", "bytes32"],
    ["0xff", factory, salt, initCodeHash]
  );
  const hash = keccak256(packed);
  return "0x" + hash.slice(-40); // últimos 20 bytes
}

let i = 0;
while (true) {
  const salt = toHex(i, { size: 32 }); // Uint → bytes32
  const addr = computeAddress(FACTORY, salt, initCodeHash);

 if (addr.startsWith("0x000") && addr.endsWith("000")) {
  console.log("Encontrado!", salt, addr);
  break;
}
/// una coincidencia más "fácil":
  // if (addr.startsWith("0x000") || addr.endsWith("0000")) {
  //   console.log("Encontrado!", salt, addr);
  //   break;
  // }

  i++;
}
