# Safe Vanity Address Generator with CREATE2

This repository provides tools and instructions to generate **vanity addresses** and deploy smart contracts at the **same address** across multiple Ethereum Virtual Machine (EVM)-compatible networks using the Safe Singleton Factory and the CREATE2 opcode. The repository includes a script (`vanity.js`) to generate a custom salt for vanity addresses and detailed steps to deploy contracts deterministically.

## Table of Contents
- [Purpose](#purpose)
- [Features](#features)
- [Prerequisites](#prerequisites)
- [How It Works](#how-it-works)
- [Usage Instructions](#usage-instructions)
  - [Step 1: Generate the InitCode](#step-1-generate-the-initcode)
  - [Step 2: Generate a Vanity Salt](#step-2-generate-a-vanity-salt)
  - [Step 3: Deploy Using Safe Singleton Factory](#step-3-deploy-using-safe-singleton-factory)
- [Example](#example)
- [Important Notes](#important-notes)
- [Contributing](#contributing)
- [License](#license)

## Purpose
This project enables developers to:
- Generate **vanity addresses** (addresses with specific prefixes) for smart contracts.
- Deploy smart contracts at the **same address** across multiple EVM-compatible networks (e.g., Ethereum, Sepolia, Polygon, etc.) using the Safe Singleton Factory and the CREATE2 opcode.
- Leverage deterministic address generation for predictable and reproducible contract deployments.

This is particularly useful for projects requiring consistent contract addresses across different networks, such as cross-chain applications or projects prioritizing branding with vanity addresses.

## Features
- **Vanity Address Generation**: Use the provided `vanity.js` script to generate a custom salt that produces a contract address with a desired prefix (e.g., `0x123...`).
- **Deterministic Deployment**: Deploy contracts at the same address on any EVM-compatible network using the Safe Singleton Factory.
- **Reusable InitCode**: Generate the contract's `initCode` once and reuse it across networks.
- **Compatibility**: Works with any EVM-compatible network supported by the Safe Singleton Factory.

## Prerequisites
- **Node.js**: Required to run the `vanity.js` script for salt generation.
- **Remix IDE**: Used to deploy and interact with the Safe Singleton Factory.
- **MetaMask**: A wallet for interacting with Remix and EVM networks.
- **Solidity Compiler**: Ensure your contract is compatible with Solidity `^0.8.21` or the version used by the Safe Singleton Factory.
- **Safe Singleton Factory Address**: `0x914d7Fec6aaC8cd542e72Bca78B30650d45643d7` (pre-deployed on multiple EVM networks).

## How It Works
The Safe Singleton Factory uses the **CREATE2** opcode to deploy contracts deterministically. The address of a contract deployed with CREATE2 is calculated as:

```
address = keccak256(0xff ++ factoryAddress ++ salt ++ keccak256(initCode))[12:]
```


- **factoryAddress**: The address of the Safe Singleton Factory (`0x914d7Fec6aaC8cd542e72Bca78B30650d45643d7`).
- **salt**: A 32-byte value used to influence the resulting address (generated by `vanity.js` for vanity addresses).
- **initCode**: The creation bytecode of the contract, including constructor arguments.

By carefully selecting the `salt` and `initCode`, you can:
1. Generate a contract address with a desired prefix (vanity address).
2. Deploy the contract at the same address on any EVM-compatible network.

## Usage Instructions

### Step 1: Generate the InitCode
The `initCode` is the creation bytecode of your contract, including any constructor arguments. To obtain it:

1. **Create a Helper Contract**:
   Deploy the `InitCodeBuilder` contract (provided below) on any EVM network (e.g., Sepolia). This contract only needs to be deployed once.
```
   // GetInit.sol
   pragma solidity ^0.8.21;

   import "./MyContract.sol"; // Replace with your actual contract

   contract InitCodeBuilder {
       function buildInit(address _owner, uint256 _param) external pure returns (bytes memory) {
           return abi.encodePacked(
               type(MyContract).creationCode,
               abi.encode(_owner, _param)
           );
       }
   }
```

### Deploy InitCodeBuilder:

Open Remix IDE (remix.ethereum.org).
Compile and deploy GetInit.sol on any EVM network (e.g., Sepolia).
Replace MyContract.sol with your actual contract and adjust the parameters in buildInit as needed.


Call buildInit:

Call the buildInit function with the desired constructor arguments (e.g., buildInit(0xYourMetaMaskAddress, 1)).
The function returns a hex string (e.g., 0x6080...). This is your initCode.



## Step 2: Generate a Vanity Salt
The salt is a 32-byte value used to influence the contract address. To generate a vanity address:

Install Dependencies:

Ensure Node.js is installed.
Clone this repository and install dependencies:
bashgit clone <repository-url>
cd <repository-folder>
npm install



Run vanity.js:

Modify the vanity.js script to specify your desired address prefix (e.g., 0x123).
Run the script:
bashnode vanity.js

The script outputs a 32-byte salt (in hex) that produces a contract address with the desired prefix when combined with your initCode.



## Step 3: Deploy Using Safe Singleton Factory
To deploy your contract at the calculated address:

Open Remix IDE:

Go to remix.ethereum.org.
Load the Safe Singleton Factory contract code from: SafeSingletonFactory.sol.
Compile the contract.


Interact with the Factory:

In Remix, go to the "Deploy & Run Transactions" tab.
Select the "At Address" option and enter the Safe Singleton Factory address: 0x914d7Fec6aaC8cd542e72Bca78B30650d45643d7.
This creates an instance of the factory with only "Low-level interactions" available.


Prepare the Calldata:

Combine the salt and initCode into a single hex string:
textcalldata = 0x + [salt in hex] + [initCode without spaces]
Example:
text0x0000000000000000000000000000000000000000000000000000000000001236080...0001



Deploy the Contract:

In the "Low-level interactions" section of Remix, paste the calldata into the input field.
Send the transaction to deploy the contract.
The contract will be deployed at the same address on any EVM network where the Safe Singleton Factory is available.



Example
Suppose you want to deploy a contract with a vanity address starting with 0x123 on both Ethereum and Polygon:

Deploy InitCodeBuilder on Sepolia and call buildInit(0xYourMetaMaskAddress, 1) to get initCode: 0x6080....
Run vanity.js with the prefix 0x123 to get a salt: 0x0000000000000000000000000000000000000000000000000000000000001234.
Combine salt and initCode into calldata: 0x00000000000000000000000000000000000000000000000000000000000012346080....
In Remix, interact with the Safe Singleton Factory at 0x914d7Fec6aaC8cd542e72Bca78B30650d45643d7 on Ethereum and Polygon, and submit the calldata.
The contract is deployed at the same address (e.g., 0x123...) on both networks.
